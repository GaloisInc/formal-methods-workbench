import "../../interfaces/uart_interface.idl4";
import "../../interfaces/test_uart__uart_packet_impl_writer.idl4";
import "../../interfaces/receiver_interface.idl4";
import "../uart_driver/uart_driver.camkes";

component uartbase {
    hardware;
    dataport Buf mem;
    emits DataAvailable	irq;
}

component uart {
	uses test_uart__uart_packet_impl_writer uart_recv;
	provides test_uart__uart_packet_impl_writer send; 

    composition {
		component uartbase uartbase; 
		component uart_driver uart;

	/* hardware connection */
        connection seL4HardwareMMIO uart_mem(from uart.uart0base, to uartbase.mem);
        connection seL4HardwareInterrupt uart_irq(from uartbase.irq, to uart.interrupt);

	/* Software connections */
		connection ExportRPC conn1(from send, to uart.send);
		connection ExportRPC conn2(from uart.recv, to uart_recv);
				
	}
	
   /* configuration {
        uartbase.mem_attributes 	= 	"0x12C30000:0x1000";    //UART1
        uartbase.irq_attributes 	= 	86;                     //UART1 interrupt
		uart.ID = 1;
    } */
   configuration {
        uartbase.mem_attributes 	= 	"0x12C10000:0x1000";    //UART1
        uartbase.irq_attributes 	= 	84;                     //UART1 interrupt
		uart.ID = 3;
    }     
}

/**************************************************************************
  End of autogenerated file: C:\docs\git_smaccm\smaccm\models\Trusted_Build_Test\test_uart\components\uart\uart.camkes.template
 **************************************************************************/

