/* This file has been autogenerated by Ivory
 * Compiler version  0.1.0.0
 */
#include "tower_task_usercode_motmix_179.h"

void nodeInit_motmix_179()
{
    struct motors n_local0 = {.frontleft =0.0f, .frontright =0.0f, .backleft =
                              0.0f, .backright =0.0f};
    struct motors* n_ref1 = &n_local0;
    
    emitFromTask_motmix_179_chan34_185(n_ref1);
}

void eventhandler_motmix_179_chan35_190(const struct controloutput* n_var0)
{
    uint8_t n_local0 = 0U;
    uint8_t* n_ref1 = &n_local0;
    struct flightmode n_local2 = {};
    struct flightmode* n_ref3 = &n_local2;
    
    read_motmix_179_dataport12_181(n_ref1);
    read_motmix_179_dataport10_183(n_ref3);
    
    uint8_t n_deref4 = *n_ref1;
    
    if (n_deref4 == 1U) {
        float n_deref5 = n_var0->throttle;
        float n_deref6 = n_var0->pitch;
        float n_deref7 = n_var0->roll;
        float n_deref8 = n_var0->yaw;
        float n_let9 = n_deref5 + 0.75f * n_deref6 + 0.75f * n_deref7 -
             (n_deref8 > (0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
                          3.0f) ? 0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
              3.0f : n_deref8 < -(1.0f * (0.1f > n_deref5 /
                                          3.0f ? 0.1f : n_deref5 /
                                          3.0f)) ? -(1.0f * (0.1f > n_deref5 /
                                                             3.0f ? 0.1f : n_deref5 /
                                                             3.0f)) : n_deref8);
        float n_let10 = n_deref5 + 0.75f * n_deref6 - 0.75f * n_deref7 +
             (n_deref8 > (0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
                          3.0f) ? 0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
              3.0f : n_deref8 < -(1.0f * (0.1f > n_deref5 /
                                          3.0f ? 0.1f : n_deref5 /
                                          3.0f)) ? -(1.0f * (0.1f > n_deref5 /
                                                             3.0f ? 0.1f : n_deref5 /
                                                             3.0f)) : n_deref8);
        float n_let11 = n_deref5 - 0.75f * n_deref6 + 0.75f * n_deref7 +
             (n_deref8 > (0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
                          3.0f) ? 0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
              3.0f : n_deref8 < -(1.0f * (0.1f > n_deref5 /
                                          3.0f ? 0.1f : n_deref5 /
                                          3.0f)) ? -(1.0f * (0.1f > n_deref5 /
                                                             3.0f ? 0.1f : n_deref5 /
                                                             3.0f)) : n_deref8);
        float n_let12 = n_deref5 - 0.75f * n_deref6 - 0.75f * n_deref7 -
             (n_deref8 > (0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
                          3.0f) ? 0.1f > n_deref5 / 3.0f ? 0.1f : n_deref5 /
              3.0f : n_deref8 < -(1.0f * (0.1f > n_deref5 /
                                          3.0f ? 0.1f : n_deref5 /
                                          3.0f)) ? -(1.0f * (0.1f > n_deref5 /
                                                             3.0f ? 0.1f : n_deref5 /
                                                             3.0f)) : n_deref8);
        float n_let13 = n_let9 < (n_let10 < (n_let11 <
                                             n_let12 ? n_let11 : n_let12) ? n_let10 : n_let11 <
                                  n_let12 ? n_let11 : n_let12) ? n_let9 : n_let10 <
             (n_let11 < n_let12 ? n_let11 : n_let12) ? n_let10 : n_let11 <
             n_let12 ? n_let11 : n_let12;
        float n_let14 = n_let9 > (n_let10 > (n_let11 >
                                             n_let12 ? n_let11 : n_let12) ? n_let10 : n_let11 >
                                  n_let12 ? n_let11 : n_let12) ? n_let9 : n_let10 >
             (n_let11 > n_let12 ? n_let11 : n_let12) ? n_let10 : n_let11 >
             n_let12 ? n_let11 : n_let12;
        float n_let15 = n_let14 > 1.0f ? 1.0f - n_let14 : n_let13 <
             7.0e-2f ? 7.0e-2f - n_let13 : 0.0f;
        struct motors n_local16 = {.frontleft =n_let9 + n_let15, .frontright =
                                   n_let10 + n_let15, .backleft =n_let11 +
                                   n_let15, .backright =n_let12 + n_let15};
        struct motors* n_ref17 = &n_local16;
        
        if (n_deref5 < 7.0e-2f) {
            *&n_ref17->frontleft = 0.0f;
            *&n_ref17->frontright = 0.0f;
            *&n_ref17->backleft = 0.0f;
            *&n_ref17->backright = 0.0f;
        }
        
        float n_deref18 = n_ref17->frontleft;
        
        if (n_deref18 < 0.0f) {
            *&n_ref17->frontleft = 0.0f;
        } else {
            if (n_deref18 > 1.0f) {
                *&n_ref17->frontleft = 1.0f;
            }
        }
        
        float n_deref19 = n_ref17->frontright;
        
        if (n_deref19 < 0.0f) {
            *&n_ref17->frontright = 0.0f;
        } else {
            if (n_deref19 > 1.0f) {
                *&n_ref17->frontright = 1.0f;
            }
        }
        
        float n_deref20 = n_ref17->backleft;
        
        if (n_deref20 < 0.0f) {
            *&n_ref17->backleft = 0.0f;
        } else {
            if (n_deref20 > 1.0f) {
                *&n_ref17->backleft = 1.0f;
            }
        }
        
        float n_deref21 = n_ref17->backright;
        
        if (n_deref21 < 0.0f) {
            *&n_ref17->backright = 0.0f;
        } else {
            if (n_deref21 > 1.0f) {
                *&n_ref17->backright = 1.0f;
            }
        }
        emitFromTask_motmix_179_chan34_185(n_ref17);
    } else {
        struct motors n_local22 = {.frontleft =0.0f, .frontright =0.0f,
                                   .backleft =0.0f, .backright =0.0f};
        struct motors* n_ref23 = &n_local22;
        
        emitFromTask_motmix_179_chan34_185(n_ref23);
    }
}